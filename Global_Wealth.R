# Objetivo :
# Ler os dados sobre distribuição de renda global encontrados em:
# https://www.credit-suisse.com/about-us/en/reports-research/global-wealth-report.html

pacman::p_load("dplyr")

p2021 <- c(2878707, 1714825, 582766, 56084)*10^3
r2021 <- c(5484, 57335, 163876, 191646)*10^9

p2020 <- c(2768, 1754, 590, 51.9)*10^6
r2020 <- c(5.4, 58.6, 161.8, 173.3)*10^12

p2019 <- c(2882528, 1661040, 499273, 46792)*10^3
r2019 <- c(6332, 55749, 140231, 158261)*10^9

p2018 <- c(3211087, 1335293, 436417, 42155)*10^3
r2018 <- c(6158, 44215, 124725, 141959)*10^9

p2017 <- c(3473673, 1053955, 390767, 36050)*10^3
r2017 <- c(7640, 32506, 111358, 128743)*10^6

p2016 <- c(3545853, 897411, 364998, 32931)*10^3
r2016 <- c(6117, 29072, 103890, 116629)*10^6

p2015 <- c(3385561, 1002596, 348928, 33717)*10^3
r2015 <- c(7416, 31267, 98513, 112949)*10^9

p2014 <- c(3281927, 1009891, 372727, 34837)*10^3
r2014 <- c(7569, 31124, 108618, 115931)*10^9

p2013 <- c(3206641, 1066351, 360454, 31680)*10^3
r2013 <- c(7.3, 33.0, 101.8, 98.7)*10^12

p2012 <- c(3184169, 1035102, 344157, 28641)*10^3
r2012 <- c(7.3, 32.1, 95.9, 87.5)*10^12

p2011 <- c(3053793, 1065693, 368716, 29674)*10^3
r2011 <- c(7.6, 33.5, 100.6, 89.1)*10^12

p2010 <- c(3038492, 1044985, 334418, 24210)*10^3
r2010 <- c(8.2, 32.1, 85.0, 69.2)*10^12

raw_data <- data.frame(matrix(nrow = 2*(2021-2010), ncol = 5)) %>%
  rename_all(~c("Ano/Categoria", "< 10k USD", "10k USD - 100k USD",
                "100k USD - 1000k USD", "1000k+ USD"))

anos <- 2010:2021
n_anos <- length(anos)
for (i in 1:n_anos) {
  pessoas <- c(paste(anos[i], "adultos", sep = "-"), get(paste0("p", anos[i])))
  renda <- c(paste(anos[i], "renda", sep = "-"), get(paste0("r", anos[i])))

  raw_data[(i*2-1),] <- pessoas
  raw_data[(i*2),] <- renda
}

write.csv(raw_data, "Global_Wealth.csv", row.names=FALSE)
